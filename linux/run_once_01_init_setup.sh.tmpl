#!/usr/bin/env zsh

{{ if eq .chezmoi.os "linux" }}
sudo apt update
sudo apt install -y \
	curl \
	git \
	wget \
	nala \
  automake \
  libncurses-dev \
  build-essential \
  libffi-dev \
  libffi8 \
  libgmp-dev \
  libgmp10 \
  libncurses-dev \
  pkg-config \
  pipx \

# cargo
which rustc > /dev/null 2>&1
retval=$?

if [ $retval -ne 0 ]; then
  curl https://sh.rustup.rs -sSf | sh
else
  echo "Rust found, skipping installation"
fi

# aqua
which aqua > /dev/null 2>&1
retval=$?

if [ $retval -ne 0 ]; then
  curl -sSfL https://raw.githubusercontent.com/aquaproj/aqua-installer/v3.0.1/aqua-installer | bash
  ln -sf ~/.local/share/aquaproj-aqua/bin/aqua ~/.local/bin/aqua
else
  echo "aqua found, skipping installation"
fi

# mise
which mise > /dev/null 2>&1
retval=$?

if [ $retval -ne 0 ]; then
  sudo install -dm 755 /etc/apt/keyrings
  wget -qO - https://mise.jdx.dev/gpg-key.pub | gpg --dearmor | sudo tee /etc/apt/keyrings/mise-archive-keyring.gpg 1> /dev/null
  echo "deb [signed-by=/etc/apt/keyrings/mise-archive-keyring.gpg arch=amd64] https://mise.jdx.dev/deb stable main" | sudo tee /etc/apt/sources.list.d/mise.list
  sudo apt update
  sudo apt install -y mise
else
  echo "mise found, skipping installation"
fi
{{ end }}
